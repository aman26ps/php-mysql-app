prometheus.remote_write "grafana" {
  endpoint {
       name = "hosted-prometheus"
      url  = "https://prometheus-prod-24-prod-eu-west-2.grafana.net/api/prom/push"
  
      basic_auth {
        username = "2528351"
        password = "glc_eyJvIjoiMTQ2OTk5NCIsIm4iOiJzdGFjay0xMzAyMDU4LWFsbG95LWdyYWZhbmEtYWxsb3kiLCJrIjoiNjQ3UnZRYTBwZW8zM2s0TjJvWEswa241IiwibSI6eyJyIjoicHJvZC1ldS13ZXN0LTIifX0="
      }
  }
}

prometheus.scrape "php_app" {
  targets = [
    { url = "http://php_app:80/metrics.php" },
  ]
  forward_to = [prometheus.remote_write.grafana.receiver]
}

prometheus.scrape "cadvisor" {
  targets = [
    { url = "http://cadvisor:8080/metrics" },
  ]
  forward_to = [prometheus.remote_write.grafana.receiver]
}

prometheus.scrape "node_exporter" {
  targets = [
    { url = "http://node-exporter:9100/metrics" },
  ]
  forward_to = [prometheus.remote_write.grafana.receiver]
}
